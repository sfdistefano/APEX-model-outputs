      SUBROUTINE NUP
!     APEX1905
!     THIS SUBPROGRAM CALCULATES THE DAILY N DEMAND FOR OPTIMAL PLANT
!     GROWTH.
      USE PARM
      IF(NUPC/=0)THEN
          X1=HUI(JJK,ISA)
          IF(SCLM(33)>0.)X1=MIN(HUI(JJK,ISA),SCLM(33))
          CNT(JJK,ISA)=(BN(4,JJK)-BN(3,JJK))*(1.-X1/(X1+EXP(BN(1,JJK)-BN(2,JJK)*X1)))+BN(3,JJK)
      ELSE
          CNT(JJK,ISA)=BN(2,JJK)+BN(1,JJK)*EXP(-BN(4,JJK)*HUI(JJK,ISA))
      END IF
      UN2=CNT(JJK,ISA)*DM(JJK,ISA)*1000.
      IF(UN2<UN1(JJK,ISA))UN2=UN1(JJK,ISA)
      UNM=MIN(4000.*BN(3,JJK)*DDM(JJK,ISA),UN2-UN1(JJK,ISA))
      UNM=MAX(0.,UNM)
      RETURN
      END