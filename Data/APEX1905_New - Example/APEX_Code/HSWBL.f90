      SUBROUTINE HSWBL(P,WYI,WYO,SSTI,SSTO,ETSA,EVRT,EVRS,DPK,RG,RGDL,&
      QWT,RBK,RSIR,WLIR,GWTR,BSNO,FSNO,BSW,FSW,BRSV,FRSV,BGWS,FGWS,FSWL,&
      ISA,KW,NBSA,MSO)
!     APEX1905
!     THIS SUBPROGRAM CHECKS THE SUBAREA SOIL WATER BALANCE AT THE END
!     OF A SIMULATION.
      DIMENSION NBSA(ISA),KW(MSO)
      DF=BSW+BSNO+BRSV+BGWS+P+WYI-WYO+SSTI-SSTO-ETSA-EVRT-EVRS-DPK+RG-&
      RGDL+QWT+RBK-RSIR-WLIR+GWTR-FSW-FSNO-FRSV-FGWS-FSWL 
      X1=.5*(BSNO+FSNO+BSW+FSW+BRSV+FRSV+BGWS+FGWS)
      X2=.5*(WYI+WYO)
      PER=100.*DF/MAX(X1,X2)
	  WRITE(KW(1),2)ISA,NBSA(ISA) 
      WRITE(KW(1),3)PER,DF,BSW,BSNO,BRSV,BGWS,P,WYI,WYO,SSTI,SSTO,&
      ETSA,EVRT,EVRS,DPK,RG,RGDL,QWT,RBK,RSIR,WLIR,GWTR,FSW,FSNO,&
      FRSV,FGWS,FSWL
      IF(ABS(PER)>1.)WRITE(KW(36),4)ISA,NBSA(ISA),PER    ! Original statement IF(ABS(PER)>1.)WRITE(KW(36),2)ISA,NBSA(ISA),PER - Luca Doro 20191009
      RETURN
    2 FORMAT(/T10,'SOIL WATER BALANCE(m3)',2X,'SA#= ',I8,1X,'ID= ',I8)
    3 FORMAT(5X,'PER =',E13.6,2X,'DF  =',E13.6,2X,'BSW =',E13.6,2X,'BSNO=',&
      E13.6,2X,'BRSV=',E13.6,2X,'BGWS=',E13.6/5X,'PCP =',E13.6,2X,'WYLI=',&
      E13.6,2X,'WYLO=',E13.6,2X,'SSTI=',E13.6,2X,'SSTO=',E13.6,2X,'ETSA=',&
      E13.6/5X,'EVRT=',E13.6,2X,'EVRS=',E13.6,2X,'DPRK=',E13.6,2X,'IRG =',&
      E13.6,2X,'IRDL=',E13.6,2X,'QIN =',E13.6/5X,'RBK =',E13.6,2X,'RSIR=',&
      E13.6,2X,'WLIR=',E13.6,2X,'GWTR=',E13.6,2X,'FSW =',E13.6,2X,'FSNO=',&
      E13.6/5X,'FRSV=',E13.6,2X,'FGWS=',E13.6,2X,'FSWL=',E13.6)
    4 FORMAT(/T10,'SOIL WATER BALANCE(m3)',2X,'SA#= ',I8,1X,'ID= ',I8,2x,'PER=',f8.0)    ! Added by Luca Doro 
      END