      SUBROUTINE RTSED
!     APEX1905
!     THIS SUBPROGRAM ROUTES SEDIMENT THRU A REACH USING A DAILY TIME
!     STEP. POTENTIAL SEDIMENT CONC IS ESTIMATED AS A FUNCTION OF
!     VELOCITY. NET DEPOSITION OR DEGRADATION MAY RESULT DEPENDING ON
!     CONC OF REACH INFLOW, VEGETATIVE COVER, AND CHANNEL ERODIBILITY.
      USE PARM 
      LD1=LID(1,IDN2)
      DEPC(IDN2)=0.
      WSAX=RWSA(IDN1)
	  WSAX1=10.*WSAX
	  WSA2=WSA(IDN2)
	  Q1M3=WYLD(IDN1)
	  Q1MM=Q1M3/WSAX1
	  Q2MM=Q1MM
      Q2M3=Q1M3
	  Y1T=YSD(NDRV,IDN1)
      VARH(33,IDO)=Q1M3/86400.
	  SMMH(33,MO,IDO)=SMMH(33,MO,IDO)+VARH(33,IDO)
	  VARH(1,IDO)=QVOL(IDN1)/86400.
	  SMMH(1,MO,IDO)=SMMH(1,MO,IDO)+VARH(1,IDO)
	  VARH(5,IDO)=Y1T
	  SMMH(5,MO,IDO)=SMMH(5,MO,IDO)+VARH(5,IDO)
	  VARH(8,IDO)=YN(IDN1)
	  SMMH(8,MO,IDO)=SMMH(8,MO,IDO)+YN(IDN1)
	  VARH(10,IDO)=YP(IDN1)	
	  SMMH(10,MO,IDO)=SMMH(10,MO,IDO)+VARH(10,IDO)
      SMMH(15,MO,IDN1)=SMMH(15,MO,IDN1)+SST(IDN1)
      YU1=YMNU(IDN1)
      RSM1=RSDM(LD1,IDN2)
      RSMC=.1*RSM1*RCHL(IDN2)*RCTW(IDN2)/WSA2
      RSMF=.1*RSM1*RFPL(IDN2)*RFPW(IDN2)/WSA2
      ADD=0.
      TOT=0.
      DO J=1,12
          TOT=TOT+STDP(J,IDN2)
          ADD=ADD+UP1(J,IDN2)
      END DO
      TP1=WSA2*(WPML(LD1,IDN2)+WPO(LD1,IDN2)+WPOU(LD1,IDN2)+TOT+ADD)
      !AD1=0.
      !DO I=1,NBSL(IDN2)
          !ISL=LID(I,IDN2)
          !AD1=AD1+PSTZ(1,ISL,IDN2)
      !END DO
      AD1=WSA2*(WBMN(LD1,IDN2)+WHSN(LD1,IDN2)+WHPN(LD1,IDN2)+WLSN(LD1,IDN2)+WLMN(LD1,IDN2))
      TOT1=WSA2*(WBMC(LD1,IDN2)+WHSC(LD1,IDN2)+WHPC(LD1,IDN2)+WLSC(LD1,IDN2)+WLMC(LD1,IDN2))
      !TOT1=WNOU(LD1,IDN2)+WNO3(LD1,IDN2)+WBMN(LD1,IDN2)+WHSN(LD1,IDN2)+&
      !WHPN(LD1,IDN2)+WLSN(LD1,IDN2)+WLMN(LD1,IDN2)
      !ADI=WPOU(LD1,IDN2)+WPMU(LD1,IDN2)
	  YC(IDN1)=MAX(0.,YC(IDN1)-YCOU(IDN1))
      YN(IDN1)=MAX(0.,YN(IDN1)-YNOU(IDN1))
      ZCH=RCHD(IDN2)
      CBW=RCBW(IDN2)
      CIN=Y1T/Q1M3+1.E-10
	  VARH(7,IDN2)=1.E6*CIN
	  CUN=YU1/Q1M3
      IF(YU1<.01)THEN
          RTNU=0.
          RTCU=0.
          RTPU=0.
      ELSE
          RTCU=YCOU(IDN1)/YU1
          RTNU=YNOU(IDN1)/YU1
          RTPU=YPOU(IDN1)/YU1
      END IF
      X4=WSAX/(360.*(DUR+TC(IDN1)))
      QAV=Q1MM*X4  ! m3/s
      XMNU=0.
      XNOU=0.
      XCOU=0.
      XPOU=0.
      DEP=0.
      DEG=0.
      CYFP=0.
      QFP=0.
      QO=0.
      Y2T=0.
      CYCH=0.
      WSU=0.
      IF(FFPQ(IDN2)>0.)THEN
          ! BUFFER
          QFP=QAV*FFPQ(IDN2)
          QQ=QAV-QFP
          FPV=Q1M3*FFPQ(IDN2) ! m3
      ELSE
          ! NORMAL SA
          IF(QCAP(IDN2)>=QAV)GO TO 1
          QQ=QCAP(IDN2)
          QFP=QAV-QCAP(IDN2)
          FPV=QFP/X4 ! m3
      END IF
      ! CALCULATE FLOOD PLAIN HYDRAULICS
      DFP=(QFP/RFPX(IDN2))**.6
      VFP=QFP/(DFP*RFPW(IDN2))
      X1=QFP*VFP
      CYFP=PRMT(19)*VFP**PRMT(18)
      SMM(79,MO,IDN2)=SMM(79,MO,IDN2)+QFP
      VAR(79,IDN2)=QFP
      VFPA(IDN2)=VFPA(IDN2)+VFP
      IF(VFP>VFPB(IDN2))VFPB(IDN2)=VFP
      NBFF(IDN2)=NBFF(IDN2)+1
      WSU=.1*RFPW(IDN2)*RFPL(IDN2)
      TRT=RFPL(IDN2)/(3.6*VFP)
      IF(LUN(IDN2)/=35)THEN
          ! NORMAL SA
          IF(FFPQ(IDN2)>0.)THEN
              ! BUFFER
              XX=FPSC(IDN2)
              FPVMM=.1*FPV/WSU
              CALL HFPF(FPVMM,TRT,XX,Q2MM)
              FPF(IDN2)=FPVMM-Q2MM
          ELSE
              ! NORMAL SA
              XX=MIN(SATC(LID(2,IDN2),IDN2),FPSC(IDN2))
              FPVMM=.1*FPV/WSA2
              FPF(IDN2)=MIN(FPVMM,XX*TRT)
          END IF
          ! FP INFILTRATION ADDED TO TOP SOIL LAYER
          X2=MIN(Q2M3,10.*FPF(IDN2)*WSU) ! m3
          FPF(IDN2)=.1*X2/WSA2 ! mm
          SWST(LD1,IDN2)=SWST(LD1,IDN2)+FPF(IDN2)
          QO=MAX(0.,FPV-X2) ! m3
          Q2M3=Q2M3-X2
          SMM(98,MO,IDN2)=SMM(98,MO,IDN2)+FPF(IDN2)
	      VARH(4,IDO)=WSAX1*FPF(IDN2)/86400.
	      SMMH(4,MO,IDO)=SMMH(4,MO,IDO)+FPF(IDN2)
      ELSE
          ! IMPERVIOUS SA
          FPF(IDN2)=0.
      END IF    
      IF(QO>0.)THEN
          ! COMPUTE FP DEGRADATION OR DEPOSITION
          X7=PRMT(45)*TRT*PSZM(IDN1)
          IF(X7<10.)THEN
              F=1.-EXP(-X7)
          ELSE
              F=1.
          END IF   
          X5=(CYFP*QO-CIN*FPV)*F
          IF(X5>0.)THEN
              DEG=EK(IDN2)*CVF(IDN2)*X5
          ELSE
              DEP=-X5
          END IF
          GO TO 11
      END IF
      ! 0 OUTFLOW
      DEP=CIN*FPV ! t
      DPU=CUN*FPV ! t
      XMNU=XMNU-DPU
      XNOU=XNOU-YNOU(IDN1)
      XCOU=XCOU-YCOU(IDN1)
      XPOU=XPOU-YPOU(IDN1)
      ! IF(XNOU>0.)WRITE(KW(1),42)IDN2,NBSA(IDN2),IY,MO,KDA,YNOU(IDN1),
      ! 1XNOU
      GO TO 34
      ! FLOW CONTAINED IN CHANNEL
    1 X1=0.
      QQ=QAV ! m3
      GO TO 34
      ! MANURE EROSION
   11 X7=2.*PRMT(45)*TRT
      IF(X7<10.)THEN
          F=1.-EXP(-X7)
      ELSE
          F=1.
      END IF
      X5=(CYFP*QO-CUN*FPV)*F
      IF(X5>0.)GO TO 32
      DGU=X5
      RTOC=RTCU
      RTON=RTNU
      RTOP=RTPU
      GO TO 33
   32 IF(RSMF<.1)GO TO 34
      DGU=MIN(.9*RSMF,.5*CVF(IDN2)*X5)
      RTON=WNOU(LD1,IDN2)/RSM1
      RTOP=WPOU(LD1,IDN2)/RSM1
      RTOC=WCOU(LD1,IDN2)/RSM1
   33 XMNU=XMNU+DGU
      XNOU=XNOU+DGU*RTON/WSAX
      XCOU=XCOU+DGU*RTOC/WSAX
      XPOU=XPOU+DGU*RTOP/WSAX
   34 IF(QQ<1.E-5)THEN
          ! 0 CHANNEL FLOW
          VCH=0.
          IF(DEP<=1.E-10.AND.DEG<1.E-10)DEP=Y1T
          GO TO 10
      END IF
      ! CALCULATE CHANNEL HYDRAULICS
      DCH=MAX(.1,ZCH*LOG10(QQ+1.)/LOG10(QCAP(IDN2)+1.))
      X3=SQRT(RCSS(IDN2)*RCSS(IDN2)+1.)
      DO IT=1,10
          A=DCH*(CBW+DCH*RCSS(IDN2))
          P=CBW+2.*X3*DCH
          Q=A**1.66667*RCHX(IDN2)/P**.66667
          FU=Q-QQ
          X6=MAX(1.,QQ)
          IF(ABS(FU/X6)<.01)EXIT
          R=A/P
          DFDD=RCHX(IDN2)*(1.6667*R**.6667*(CBW+2.*DCH*RCSS(IDN2))-1.333&
          *R**1.66667*X3)
          DCH=DCH-FU/DFDD
      END DO
      IF(IT>10)WRITE(KW(1),16)IDN2,NBSA(IDN2),IYR,MO,KDA,QQ,Q,DFDD,DCH,ZCH
      VCH=QQ/A
      TRT=RCHL(IDN2)/(3.6*VCH)
      CYCH=PRMT(19)*VCH**PRMT(18)
      VCHA(IDN2)=VCHA(IDN2)+VCH
      IF(VCH>VCHB(IDN2))VCHB(IDN2)=VCH
      NBCF(IDN2)=NBCF(IDN2)+1
      CHV=QQ/X4 ! m3
      ! CALCULATE CH DEGRADATION OR DEPOSITION  
      X7=PRMT(45)*TRT*PSZM(IDN1)
      IF(X7<10.)THEN
          F=1.-EXP(-X7)
      ELSE
          F=1.
      END IF   
      X5=(CYCH-CIN)*CHV
      IF(X5>0.)THEN
          X5=RCHK(IDN2)*X5
          DEG=DEG+X5
      ELSE
          DEP=DEP-X5*F
          DPMT(IDN2)=DPMT(IDN2)-X5
          ZCH=ZCH+.1*X5/BD(LD1,IDN2)
      END IF
      ! CALCULATE CH MANURE EROSION
      X7=2.*PRMT(45)*TRT
      IF(X7<10.)THEN
          F=1.-EXP(-X7)
      ELSE
          F=1.
      END IF   
      X5=(CYCH-CUN)*CHV
      IF(X5>0.)THEN
          IF(RSMC<.1)GO TO 41
          DGU=MIN(.9*RSMC,.5*RCHC(IDN2)*X5)
          RTON=WNOU(LD1,IDN2)/RSM1
          RTOP=WPOU(LD1,IDN2)/RSM1
          RTOC=WCOU(LD1,IDN2)/RSM1
      ELSE
          DGU=X5*F
          RTOC=RTCU
          RTON=RTNU
          RTOP=RTPU
      END IF   
      XMNU=XMNU+DGU
      XNOU=XNOU+DGU*RTON/WSAX
      XCOU=XCOU+DGU*RTOC/WSAX
      XPOU=XPOU+DGU*RTOP/WSAX
   41 DO I=1,NBSL(IDN2)
          ISL=LID(I,IDN2)
          IF(ZCH<Z(ISL,IDN2))EXIT
      END DO
      ! CHANGE CH DEPTH CAUSED BY DEP/DEG 
      ZCH=ZCH+.1*X5/BD(ISL,IDN2)
      ! CALCULATE PEAK FLOW RATE OF OUTFLOW
   10 VAV=MAX(.1,(X1+VCH*QQ)/QAV)
      TRT=RCHL(IDN2)/(3.6*VAV)
      TC(IDO)=TC(IDN1)+TRT
      TCAV(IDO)=TCAV(IDO)+TC(IDO)
      ALTC=1.-EXP(-TC(IDO)*PRFF)
      RQRB(IDO)=ALTC*Q1MM/TC(IDO) ! mm/h
      PRAV(IDO)=PRAV(IDO)+RQRB(IDO)
      IF(RQRB(IDO)>PRB(IDO))PRB(IDO)=RQRB(IDO)
      NQRB(IDO)=NQRB(IDO)+1
      IF(TC(IDO)>TCMX(IDO))THEN
          TCMX(IDO)=TC(IDO)
      ELSE
          IF(TC(IDO)<TCMN(IDO))TCMN(IDO)=TC(IDO)
      END IF
      ! CALCULATE OUTFLOW SEDIMENT LOAD
      Y2T=MAX(0.,Y1T-DEP) ! t
      Y2T=Y2T+DEG
      !XX=10.*(CYCH*Q3+CYFP*QO)
      !IF(XX<Y1)Y2=(.5*Y1+XX)/1.5
      ! RECOMPUTE DEP/DEG
      IF(Y1T>Y2T)THEN
          DEP=Y1T-Y2T
          DEG=0.
      ELSE
          DEP=0.
          DEG=Y2T-Y1T
      END IF      
      SRCH(14,IDO)=SRCH(14,IDO)+DEG ! t
      SRCH(13,IDO)=SRCH(13,IDO)+DEP ! t
	  SDEP=SDEP+DEP
	  SDEG=SDEG+DEG
      ! COMPUTE EVAPORATION FROM FLOW
	  EVRT(IDN2)=MIN(Q2M3,10.*PRMT(91)*EO*WSU) ! m3
	  SMM(147,MO,IDN2)=SMM(147,MO,IDN2)+EVRT(IDN2)
      VAR(147,IDN2)=EVRT(IDN2)
	  VARH(3,IDO)=EVRT(IDN2)/86400.
	  SMMH(3,MO,IDO)=SMMH(3,MO,IDO)+VARH(3,IDO)
	  Q2M3=Q2M3-EVRT(IDN2)
      RSM1=WSA2*RSM1
      IF(Q2M3<1.E-10)Y2T=0.
      ! RECALCULATE MANURE EROSION
	  IF(RSM1>YU1)THEN
          X2=YU1
	  ELSE
	      X2=RSM1
	  END IF 
      X1=X2-XMNU
	  IF(X1<0.)XMNU=-X2
      YU2=YU1+XMNU
	  RSDM(LD1,IDN2)=(RSM1+YU1-YU2)/WSA2
	  ZZ=WLS(LD1,IDN2)+WLM(LD1,IDN2)
      RTO=WLS(LD1,IDN2)/(ZZ*WSA2)
      WLS(LD1,IDN2)=MAX(0.,WLS(LD1,IDN2)-RTO*XMNU)
      WLM(LD1,IDN2)=WLM(LD1,IDN2)-XMNU*(1.-RTO)
      WNOU(LD1,IDN2)=MAX(0.,WNOU(LD1,IDN2)-XNOU)
      WCOU(LD1,IDN2)=MAX(0.,WCOU(LD1,IDN2)-XCOU)
      WPOU(LD1,IDN2)=MAX(0.,WPOU(LD1,IDN2)-XPOU)
      TOT=0.
      ! COMPUTE DELIVERY RATIO
      DRTO=MIN(1.,Y2T/(Y1T+1.E-10))
	  DRTO=MAX(1.E-5,DRTO)
      DRAV(IDO)=DRAV(IDO)+DRTO
      B1=LOG(DRTO)/4.47
      ! CALCULATE PARTICLE SIZE DISTRIBUTION OF OUTFLOW SEDIMENT
      DO I=1,NSZ
	      PCTH(I,IDO)=PCT(I,IDN1)
          X1=MAX(-10.,B1*PSZY(I))
          PCT(I,IDO)=PCT(I,IDN1)*EXP(X1)
          TOT=TOT+PCT(I,IDO)
      END DO
      PSZM(IDO)=0.
      DO I=1,NSZ
          PCT(I,IDO)=PCT(I,IDO)/(TOT+1.E-10)
          PSZM(IDO)=PSZM(IDO)+PSZY(I)*PCT(I,IDO)
      END DO
      ! COMPUTE ENRICHMENT RATIO FOR N & P
      IF(IERT==0)THEN
          B2=LOG10(DRTO)/2.699
          B1=1./.1**B2
          ERTO=MIN(3.5,B1*CIN**B2)
          IF(ERTO<1.)THEN
              ERTO=1.
              ERTP=1.
          END IF  
          ERTP=ERTO
      ELSE
          ERTO=MIN(3.5,PRMT(54)/CIN**PRMT(55))
          ERTP=MIN(3.5,PRMT(57)/CIN**PRMT(58))
      END IF
      ERAV(IDO)=ERAV(IDO)+ERTO
	  YNOU(IDO)=MAX(0.,YNOU(IDN1)+XNOU)
      YCOU(IDO)=MAX(0.,YCOU(IDN1)+XCOU)
	  RTO=MIN(ERTO*Y2T/(Y1T+1.E-10),1.)
      YN(IDO)=MAX(0.,YN(IDN1)*RTO)
      YC(IDO)=MAX(0.,YC(IDN1)*RTO)
      YN(IDO)=YN(IDO)+YNOU(IDO)
      X3=YN(IDN1)+YNOU(IDN1)-YN(IDO)
      X1=1.+X3/AD1
      WBMN(LD1,IDN2)=WBMN(LD1,IDN2)*X1
      WHSN(LD1,IDN2)=WHSN(LD1,IDN2)*X1
      WHPN(LD1,IDN2)=WHPN(LD1,IDN2)*X1
      WLSN(LD1,IDN2)=WLSN(LD1,IDN2)*X1
      WLMN(LD1,IDN2)=MAX(0.,WLMN(LD1,IDN2)*X1)
      X2=X2-XNOU
      SMM(91,MO,IDN2)=SMM(91,MO,IDN2)+X2
      VAR(91,IDN2)=X2
      YC(IDO)=YC(IDO)+YCOU(IDO)
      X3=YC(IDN1)+YCOU(IDN1)-YC(IDO)
      SMM(102,MO,IDN2)=SMM(102,MO,IDN2)+X3
      VAR(102,IDN2)=X3
      DEPC(IDN2)=X3
      !X2=YC(IDN1)-YC(IDO)
      X1=1.+X3/TOT1
      WBMC(LD1,IDN2)=WBMC(LD1,IDN2)*X1
      WHSC(LD1,IDN2)=WHSC(LD1,IDN2)*X1
      WHPC(LD1,IDN2)=WHPC(LD1,IDN2)*X1
      WLSC(LD1,IDN2)=WLSC(LD1,IDN2)*X1
      WLMC(LD1,IDN2)=WLMC(LD1,IDN2)*X1
      X4=MIN(1.,WLMC(LD1,IDN2)/(WLMC(LD1,IDN2)+WLSC(LD1,IDN2)))
      !WLMC(LD1,IDN2)=WLMC(LD1,IDN2)-X4*XCOU
      !WLSC(LD1,IDN2)=MAX(0.,WLSC(LD1,IDN2)-XCOU*(1.-X4))
      YPOU(IDO)=MAX(0.,YPOU(IDN1)+XPOU)
      YP(IDO)=MAX(0.,YP(IDN1)*RTO)
      YPM(IDO)=MAX(0.,YPM(IDN1)*RTO)
      X2=(YP(IDN1)-YP(IDO))/WSA2
      WPO(LD1,IDN2)=WPO(LD1,IDN2)+X2
      X2=X2-XPOU
      SMM(92,MO,IDN2)=SMM(92,MO,IDN2)+X2
      VAR(92,IDN2)=X2
      YSD(NDRV,IDO)=Y2T
      YMNU(IDO)=MAX(0.,YU2)
      ! CALCULATE WATER YIELD COMPONENTS OF OUTFLOW
	  QQ=Q2M3/Q1M3
	  QVOL(IDO)=QVOL(IDN1)*QQ
	  RSSF(IDO)=RSSF(IDN1)*QQ
	  QDR(IDO)=QDR(IDN1)*QQ
	  QRF(IDO)=QRF(IDN1)*QQ
	  CPVH(IDO)=CPVH(IDN1)*QQ
	  WYLD(IDO)=Q2M3
      X1=.1*Q2M3/(WSAX+WSA2)
      ! CALCULATE SOLUBLE N LOSS COMPONENTS
	  RSFN(IDO)=RSFN(IDN1)*QQ
	  QRFN(IDO)=QRFN(IDN1)*QQ
	  TSFN(IDO)=TSFN(IDN1)*QQ
	  QDRN(IDO)=QDRN(IDN1)*QQ
	  QDRP(IDO)=QDRP(IDN1)*QQ
      XX=1.-QQ
      ! CALCULATE SOLUBLE C COMPONENTS OF OUTFLOW
      X2=QC(IDN1)*XX
      QC(IDO)=QC(IDN1)-X2
      SMM(102,MO,IDN2)=SMM(102,MO,IDN2)+X2
      VAR(102,IDN2)=VAR(102,IDN2)+X2
      ! COMPUTE SOLUBLE C DEPOSITION AND ADD TO TOP SOIL LAYER
      DEPC(IDN2)=DEPC(IDN2)+X2
      X2=X2/WSA2
      WBMC(LD1,IDN2)=WBMC(LD1,IDN2)+X2
      WCMU(LD1,IDN2)=WCMU(LD1,IDN2)+X2
      ! COMPUTE SOLUBLE N DEPOSITION AND ADD TO TOP SOIL LAYER
      X2=QN(IDN1)*XX
      QN(IDO)=QN(IDN1)-X2
      SMM(91,MO,IDN2)=SMM(91,MO,IDN2)+X2
      VAR(91,IDN2)=VAR(91,IDN2)+X2
      WNO3(LD1,IDN2)=WNO3(LD1,IDN2)+X2/WSA2
      SMQN(IDO)=QN(IDO)+RSFN(IDO)+QRFN(IDO)+QDRN(IDO)
      ! COMPUTE SOLUBLE P DEPOSITION AND ADD TO TOP SOIL LAYER
      X2=QP(IDN1)*XX
      QP(IDO)=QP(IDN1)-X2
      WPML(LD1,IDN2)=WPML(LD1,IDN2)+X2/WSA2
	  SMM(92,MO,IDN2)=SMM(92,MO,IDN2)+X2
      VAR(92,IDN2)=VAR(92,IDN2)+X2
      !ADF=WPOU(LD1,IDN2)+WPMU(LD1,IDN2)
      !DPPX=ADI-ADF
      !DF=DPPX+YPOU(IDN1)-YPOU(IDO)+QPU(IDN1)-QPU(IDO)
      !IF(ABS(DF)>.001.OR.ABS(DPPX-VAR(92,IDN2))>.001)WRITE(KW(1),'(A,5I4,10E13.5)')&
      !' ?????',IDN2,NBSA(IDN2),IY,MO,KDA,YPOU(IDN1),YPOU(IDO),QPU(IDN1),&
      !QPU(IDO),VAR(92,IDN2),DPPX,ADI,ADF,DF
      !TOT2=WNOU(LD1,IDN2)+WNO3(LD1,IDN2)+WBMN(LD1,IDN2)+WHSN(LD1,IDN2)+&
      !WHPN(LD1,IDN2)+WLSN(LD1,IDN2)+WLMN(LD1,IDN2)
      !TOT2=WSA2*(WBMC(LD1,IDN2)+WHSC(LD1,IDN2)+WHPC(LD1,IDN2)+WLSC(LD1,IDN2)+WLMC(LD1,IDN2))
      !DF=TOT1-TOT2+VYC(IDN1)-YC(IDO)+QC(IDN1)-QC(IDO)
      !IF(ABS(DF)>.01)WRITE(KW(1),'(A,5I4,20E13.5)')' !!!!!',IDN2,NBSA(IDN2),&
      !IY,MO,KDA,VYC(IDN1),YC(IDO),YCOU(IDN1),YCOU(IDO),QC(IDN1),QC(IDO),&
      !DEPC(IDN2),TOT1,TOT2,DF
      !DF=TOT1-TOT2+YN(IDN1)-YN(IDO)+QN(IDN1)-QN(IDO)+YNOU(IDN1)-YNOU(IDO)
      !IF(ABS(DF)>.01)WRITE(KW(1),'(A,5I4,20E13.5)')' !!!!!',IDN2,NBSA(IDN2),&
      !IY,MO,KDA,YN(IDN1),YN(IDO),YNOU(IDN1),YNOU(IDO),QN(IDN1),QN(IDO),&
      !TOT1,TOT2,DF
	  SP1=0.
	  SP2=0.
	  SP3=0.
	  SP4=0.
	  AD4=0.
	  DO K=1,NDP !PESTICIDE LOOP
	      TOT=0.
	      AD3=0.
	      X1=WSAX*QPST(K,IDN1)
          AD3=AD3+X1
	      X2=QQ*X1
	      TOT=TOT+X1-X2
		  QPST(K,IDO)=X2/WSAX
		  X1=WSAX*TSPS(K,IDN1)
		  AD3=AD3+X1
	      X2=QQ*X1
	      TOT=TOT+X1-X2
		  TSPS(K,IDO)=X2/WSAX
		  X1=WSAX*RSPS(K,IDN1)
		  AD3=AD3+X1
	      X2=QQ*X1
	      TOT=TOT+X1-X2
		  RSPS(K,IDO)=X2/WSAX
	      X3=TOT/WSA2
	      AD4=AD4+X3
		  PSTZ(K,LD1,IDN2)=PSTZ(K,LD1,IDN2)+X3
		  VARP(2,K,IDO)=QPST(K,IDO)
          SMMP(2,K,MO,IDO)=SMMP(2,K,MO,IDO)+QPST(K,IDO)
          VARP(4,K,IDO)=TSPS(K,IDO)
          SMMP(4,K,MO,IDO)=SMMP(4,K,MO,IDO)+TSPS(K,IDO)
          X1=WSAX*YPST(K,IDN1)
          AD3=AD3+X1
	      X2=X1*RTO
	      X3=(X1-X2)/WSA2
	      PSTZ(K,LD1,IDN2)=PSTZ(K,LD1,IDN2)+X3
	      AD3=AD3/WSA2
	      SMMP(13,K,MO,IDOA(IDN2))=SMMP(13,K,MO,IDOA(IDN2))+AD3
		  YPST(K,IDO)=X2/WSAX
          VARP(5,K,IDO)=YPST(K,IDO)
          SMMP(5,K,MO,IDO)=SMMP(5,K,MO,IDO)+YPST(K,IDO)
          VARP(11,K,IDO)=RSPS(K,IDO)
          SMMP(11,K,MO,IDO)=SMMP(11,K,MO,IDO)+RSPS(K,IDO)
          SP1=SP1+QPST(K,IDN1)
	      SP2=SP2+QPST(K,IDO)
	      SP3=SP3+YPST(K,IDN1)
          SP4=SP4+YPST(K,IDO)
      END DO ! PESTICIDE LOOP
      ADD=0.
      TOT=0.
      DO J=1,12
          TOT=TOT+STDP(J,IDN2)
          ADD=ADD+UP1(J,IDN2)
      END DO
      !TP2=WSA2*(WPML(LD1,IDN2)+WPO(LD1,IDN2)+WPOU(LD1,IDN2)+TOT+ADD)
      !DF=TP1+YP(IDN1)-YP(IDO)+QP(IDN1)-QP(IDO)-TP2
      !IF(ABS(DF)>1.)WRITE(KW(1),20)IY,MO,KDA,YP(IDN1),YP(IDO),QP(IDN1),QP(IDO),&
      !TP1,TP2,DF
      !AD2=0.
      !DO I=1,NBSL(IDN2)
          !ISL=LID(I,IDN2)
          !AD2=AD2+PSTZ(1,ISL,IDN2)
      !END DO
      !DF=AD1+(WSAX*(QPST(1,IDN1)+TSPS(1,IDN1)+RSPS(1,IDN1)+YPST(1,&
      !IDN1))-RWSA2*(QPST(1,IDO)+TSPS(1,IDO)+RSPS(1,IDO)+YPST(1,&
      !IDO)))/WSA2-AD2
      !IF(ABS(DF)>.001)WRITE(KW(1),20)IY,MO,KDA,AD1,QPST(1,IDN1),TSPS(1,&
      !IDN1),RSPS(1,IDN1),YPST(1,IDN1),QPST(1,IDO),TSPS(1,IDO),RSPS(1,&
      !IDO),YPST(1,IDO),AD2,DF
   	  VARH(34,IDO)=Q2M3
	  SMMH(34,MO,IDO)=SMMH(34,MO,IDO)+Q2M3
      VARH(35,IDO)=Q2M3/86400.
	  SMMH(35,MO,IDO)=SMMH(35,MO,IDO)+VARH(35,IDO)
      VARH(2,IDO)=QVOL(IDO)/86400.
	  SMMH(2,MO,IDO)=SMMH(2,MO,IDO)+VARH(2,IDO)
	  VARH(6,IDO)=Y2T
	  SMMH(6,MO,IDO)=SMMH(6,MO,IDO)+VARH(6,IDO)
	  VARH(9,IDO)=YN(IDO)
	  SMMH(9,MO,IDO)=SMMH(9,MO,IDO)+YN(IDO)
	  VARH(11,IDO)=YP(IDO)+YPOU(IDO)
	  SMMH(11,MO,IDO)=SMMH(11,MO,IDO)+VARH(11,IDO)
	  VARH(12,IDO)=SMQN(IDN1)
	  SMMH(12,MO,IDO)=SMMH(12,MO,IDO)+SMQN(IDN1)
	  VARH(13,IDO)=QN(IDO)    !SMQN(IDO)
	  SMMH(13,MO,IDO)=SMMH(13,MO,IDO)+QN(IDO)    !SMQN(IDO)
	  VARH(18,IDO)=QP(IDN1)
	  SMMH(18,MO,IDO)=SMMH(18,MO,IDO)+VARH(18,IDO)
	  VARH(19,IDO)=QP(IDO)
	  SMMH(19,MO,IDO)=SMMH(19,MO,IDO)+VARH(19,IDO)
	  VARH(26,IDO)=WSAX*SP1
	  SMMH(26,MO,IDO)=SMMH(26,MO,IDO)+VARH(26,IDO)
	  VARH(27,IDO)=WSAX*SP2
	  SMMH(27,MO,IDO)=SMMH(27,MO,IDO)+VARH(27,IDO)
	  VARH(28,IDO)=WSAX*SP3
	  SMMH(28,MO,IDO)=SMMH(28,MO,IDO)+VARH(28,IDO)
	  VARH(29,IDO)=WSAX*SP4
	  SMMH(29,MO,IDO)=SMMH(29,MO,IDO)+VARH(29,IDO)
	  VARH(32,IDO)=WSAX*(SP3-SP4)	
      SMMH(32,MO,IDO)=SMMH(32,MO,IDO)+VARH(32,IDO)
      RETURN
   16 FORMAT(1X,'_______________RTSED DCH XCONV______________',&
      2I8,1X,3I4,5E13.5)
   !20 FORMAT(1X,'!!!!!',3I4,20E13.5)     
      END